# neptunus
Раннер конвейеров обработки данных  
  
Заточен под событийную модель, поддерживает шесть видов плагинов:
 - входные - плагины-потребители данных снаружи
 - процессоры - плагины-преобразователи данных
 - выходные - плагины-отправители событий внешним потребителям
 - фильтры - плагины-фильтры событий
 - парсеры - плагины-преобразователи сырых данных определенных форматов в полезную нагрузку событий
 - сериализаторы - плагины-преобразователи событий в те или иные форматы данных

Поддерживает несколько одновременно работающих независимых пайплайнов.  
Поддерживает несколько параллельных линий процессоров в рамках одного пайплайна, для ситуаций, когда события читаются быстрее, чем обрабатываются в один "поток".  
> **Важно!** Опытным путём установлено, что скейлинг может снизить производительность, если процессоры суммарно обрабатывают события быстрее, чем выходы их отправляют (буферы соединяющих каналов заполняются полностью). Использовать, предварительно протестировав.  
  
Конфигурация делится на две части - на конфигурацию приложения и на пайплайны.  
Пайплайн состоит из хотя бы одного входа, хотя бы одного выхода и, опционально процессоров. Каждому плагину можно назначить несколько фильтров, но только по одному каждого типа.  
Фильтр имеет один вход и два выхода - для прошедших фильтрацию и для отклоненных событий. В случае процессоров, отклоненные события отправляются дальше по пайплайну, не доходя до плагина. В случае входов и выходов, отклоненные события удаляются.

# TODO
## Common
 - [x] реализовать пайплайн менеджер для управления пайплайнами (старт/стоп/обновление по сигналу)
 - [ ] написать структуру, реализующую батчинг для плагинов ИЛИ плагин с примером реализации
 - [x] добавить плагины-парсеры для входов
 - [x] добавить плагины-сериализаторы для выходов (тут можно обойтись гошными темплейтами?)
 - [ ] исследовать работу с бинарными данными (энкодинг, декодинг, потребности в обработке)
 - [ ] написать юниты строгой консистентности

## Inputs
 - [ ] кафка, чтение из партиции, чтение в группе консьюмеров
 - [ ] рэббит

## Outputs
Должны поддерживать буферизацию и параметризируемый батчинг
 - [ ] кафка
 - [ ] рэббит
 - [ ] эластик
 - [ ] постгрес

## Filters
 - [x] глобы для роутинг кея, полей и лейблов для строк
 - [ ] больше (или равно), меньше (или равно), равно для чисел

## Procecssors
 - [ ] регулярки
 - [ ] старларк

## Менеджмент пайплайнов
 - [ ] Реализовать возможность хранить пайпланйы в разных хранилищах:
   - [x] файлы (уже реализовано сейчас, но описание пайплайна и его конфигурация оторваны друг от друга, поэтому рефакторинг)
   - [ ] база данных
   - [ ] КВ сторадж, например, консула

 - [x] Реализовать работающий с стораджем менеджер пайплайнов. Менеджер пайплайнов должен уметь:
   - запускать пайплайны, вычитывая их из стораджа
   - останавливать конкретный пайплайн
   - запускать конкретный пайплайн
   - сохранять в сторадж новый пайплайн
   - обновлять/удалять конкретный пайплайн
  
 - [x] Реализовать REST апи над менеджером пайплайнов. Апи должен иметь ручки для остановки, запуска, обновления (с опциональным перезапуском), удаления с остановкой, сохранения нового (с опциональным запуском).

 - [x] Реализовать gRPC апи над менеджером пайплайнов аналогично REST
  
 - [ ] Реализовать фронты для управления пайплайнами, которые будут ходить в апи и делать указанное.
  
 - [ ] **(?)** Реализовать межсервисное взаимодействие (одноранговый кластер) через gRPC.
