This code has been adopted from https://github.com/pbnjay/memory
